---
# SSL 인증서 설치 및 갱신 설정
packages:
  yum:
    certbot: []
    python3-certbot-nginx: []

commands:
  01_create_cert_dir:
    command: |
      mkdir -p /etc/letsencrypt/live/api.scentist.link
    ignoreErrors: true
  
  02_check_cert:
    command: |
      if [ ! -f /etc/letsencrypt/live/api.scentist.link/fullchain.pem ]; then
        echo "Certificate not found, will try to obtain one"
        systemctl stop nginx 2>/dev/null || true
        certbot certonly --standalone --non-interactive --agree-tos \
          --email your-email@example.com -d api.scentist.link
        systemctl start nginx 2>/dev/null || true
      fi
    ignoreErrors: true